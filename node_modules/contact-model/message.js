import Transmission from 'contact-model/transmission'
import Privacy from 'contact-model/privacy'

const privacy = new Privacy()

class MessageTransmission extends Transmission {
  type = 'm'
  static seals = [
    encrypt
  ]

  isEmpty () {
    return ['', null, undefined].includes(this.payload)
  }

  // seal () {
  //   for (const sealFn of this.constructor.seals) {
  //     sealFn(this)
  //   }
  // }

  // static unseal (sealed) {
  //   const message = new this()
  //   message.type = sealed.type
  //   message.datetime = sealed.datetime
  //   message.headers = sealed.headers
  //   message.payload = privacy.decrypt(sealed.payload)
  //   return message
  // }
}

export default MessageTransmission

function encrypt (message) {
  message.payload = privacy.encrypt(message.payload)
  return message
}
